(()=>{"use strict";var e;!function(e){e[e.Active=0]="Active",e[e.Finished=1]="Finished"}(e||(e={}));class t{constructor(e,t,n,r,s){this.id=e,this.title=t,this.description=n,this.people=r,this.status=s}}class n{constructor(e,t,n,r){this.templateElement=document.getElementById(e),this.hostElement=document.getElementById(t);const s=document.importNode(this.templateElement.content,!0);this.element=s.firstElementChild,r&&(this.element.id=r),this.attach(n)}attach(e){this.hostElement.insertAdjacentElement(e?"afterbegin":"beforeend",this.element)}}function r(e,t,n){return console.log(n),{configurable:!0,enumerable:!1,get(){return n.value.bind(this)}}}class s extends class{constructor(){this.listeners=[]}addListener(e){this.listeners.push(e)}}{constructor(){super(),this.projects=[]}static getInstance(){return this.instance||(this.instance=new s),this.instance}addProject(n,r,s){const i=new t(Math.random().toString(),n,r,s,e.Active);this.projects.push(i),console.log(this.projects),this.updateListeners()}moveProject(e,t){const n=this.projects.find((t=>t.id===e));n&&n.status!==t&&(n.status=t,this.updateListeners())}updateListeners(){for(const e of this.listeners)e(this.projects.slice())}}const i=s.getInstance();class l extends n{constructor(e,t){super("single-project",e,!1,t.id),this.project=t,this.configure(),this.renderContent()}get persons(){return 1===this.project.people?"1 person":`${this.project.people} persons`}dragStartHandler(e){console.dir(e.dataTransfer),e.dataTransfer.setData("text/plain",this.project.id),e.dataTransfer.effectAllowed="move"}dragEndHandler(e){console.log("drag end")}configure(){this.element.addEventListener("dragstart",this.dragStartHandler),this.element.addEventListener("dragend",this.dragEndHandler)}renderContent(){this.element.querySelector("h2").textContent=this.project.title,this.element.querySelector("h3").textContent=this.persons+" assigned",this.element.querySelector("p").textContent=this.project.description}}!function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);i>3&&l&&Object.defineProperty(t,n,l)}([r],l.prototype,"dragStartHandler",null);var o=function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l};class a extends n{constructor(e){super("project-list","app",!1,`${e}-projects`),this.type=e,this.assignedProjects=[],this.configure(),this.renderContent()}dragOverHandler(e){e.dataTransfer&&"text/plain"===e.dataTransfer.types[0]&&(e.preventDefault(),this.element.querySelector("ul").classList.add("droppable"))}dropHandler(t){const n=t.dataTransfer.getData("text/plain");i.moveProject(n,"active"===this.type?e.Active:e.Finished)}dragLeaveHandler(e){this.element.querySelector("ul").classList.remove("droppable")}configure(){this.element.addEventListener("dragover",this.dragOverHandler),this.element.addEventListener("dragleave",this.dragLeaveHandler),this.element.addEventListener("drop",this.dropHandler),i.addListener((t=>{const n=t.filter((t=>"active"===this.type?t.status===e.Active:t.status===e.Finished));this.assignedProjects=n,this.renderProjects()}))}renderContent(){const e=`${this.type}-projects-list`;this.element.querySelector("ul").id=e,this.element.querySelector("h2").textContent=this.type.toUpperCase()+" PROJECTS"}renderProjects(){document.querySelector(`#${this.type}-projects-list`).innerHTML="";for(const e of this.assignedProjects)new l(this.element.querySelector("ul").id,e)}}function c(e){let t=!0;return e.required&&(t=t&&0!==e.value.toString().trim().length),null!=e.minLength&&"string"==typeof e.value&&(t=t&&e.value.length>=e.minLength),null!=e.maxLength&&"string"==typeof e.value&&(t=t&&e.value.length<=e.maxLength),null!=e.min&&"number"==typeof e.value&&(t=t&&e.value>=e.min),null!=e.max&&"number"==typeof e.value&&(t=t&&e.value<=e.max),t}o([r],a.prototype,"dragOverHandler",null),o([r],a.prototype,"dropHandler",null),o([r],a.prototype,"dragLeaveHandler",null);class d extends n{constructor(){super("project-input","app",!0,"user-input"),this.titleInputElement=this.element.querySelector("#title"),this.descriptionInputElement=this.element.querySelector("#description"),this.peopleInputElement=this.element.querySelector("#people"),this.configure()}configure(){this.element.addEventListener("submit",this.submitHandler)}renderContent(){}gatherUserInput(){const e=this.titleInputElement.value,t=this.descriptionInputElement.value,n=this.peopleInputElement.value,r={value:t,required:!0,minLength:5},s={value:+n,required:!0,min:1,max:5};return c({value:e,required:!0})&&c(r)&&c(s)?[e,t,+n]:void alert("invalid input, please try again")}clearInputs(){this.titleInputElement.value="",this.descriptionInputElement.value="",this.peopleInputElement.value=""}submitHandler(e){e.preventDefault(),console.log(this.titleInputElement.value);const t=this.gatherUserInput();if(Array.isArray(t)){const[e,n,r]=t;i.addProject(e,n,r),console.log(e,n,r),this.clearInputs()}}}(function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);i>3&&l&&Object.defineProperty(t,n,l)})([r],d.prototype,"submitHandler",null),new d,new a("active"),new a("finished")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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S1EsUUFBUXNELGlCQUFpQixTQUFVOUQsS0FBS29HLGVBRy9DL0MsaUJBSVFnRCxrQkFDTixNQUFNQyxFQUFldEcsS0FBS2lHLGtCQUFrQjNFLE1BQ3RDaUYsRUFBcUJ2RyxLQUFLa0csd0JBQXdCNUUsTUFDbERrRixFQUFnQnhHLEtBQUttRyxtQkFBbUI3RSxNQU14Q21GLEVBQXNDLENBQzFDbkYsTUFBT2lGLEVBQ1BkLFVBQVUsRUFDVkcsVUFBVyxHQUVQYyxFQUFpQyxDQUNyQ3BGLE9BQVFrRixFQUNSZixVQUFVLEVBQ1ZLLElBQUssRUFDTEMsSUFBSyxHQUdQLE9BQ0dULEVBakJtQyxDQUNwQ2hFLE1BQU9nRixFQUNQYixVQUFVLEtBZ0JUSCxFQUFTbUIsSUFDVG5CLEVBQVNvQixHQUtILENBQUNKLEVBQWNDLEdBQXFCQyxRQUgzQ0csTUFBTSxtQ0FPRkMsY0FDTjVHLEtBQUtpRyxrQkFBa0IzRSxNQUFRLEdBQy9CdEIsS0FBS2tHLHdCQUF3QjVFLE1BQVEsR0FDckN0QixLQUFLbUcsbUJBQW1CN0UsTUFBUSxHQUkxQjhFLGNBQWM1QyxHQUNwQkEsRUFBTWMsaUJBQ05yRCxRQUFRQyxJQUFJbEIsS0FBS2lHLGtCQUFrQjNFLE9BQ25DLE1BQU11RixFQUFZN0csS0FBS3FHLGtCQUV2QixHQUFJUyxNQUFNQyxRQUFRRixHQUFZLENBQzVCLE1BQU90SCxFQUFPeUgsRUFBTXZILEdBQVVvSCxFQUM5QjdELEVBQWFmLFdBQVcxQyxFQUFPeUgsRUFBTXZILEdBQ3JDd0IsUUFBUUMsSUFBSTNCLEVBQU95SCxFQUFNdkgsR0FDekJPLEtBQUs0RyxpQiwyVEFUVCxFQURDL0YsRyxrQ0NwREgsSUFBSW1GLEVBQ0osSUFBSS9CLEVBQVksVUFDaEIsSUFBSUEsRUFBWSxhIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VjdGlvbjkvLi9zcmMvbW9kZWxzL3Byb2plY3QudHMiLCJ3ZWJwYWNrOi8vc2VjdGlvbjkvLi9zcmMvY29tcG9uZW50cy9iYXNlLWNvbXBvbmVudC50cyIsIndlYnBhY2s6Ly9zZWN0aW9uOS8uL3NyYy9kZWNvcmF0b3JzL2F1dG9iaW5kLnRzIiwid2VicGFjazovL3NlY3Rpb245Ly4vc3JjL3N0YXRlL3Byb2plY3Qtc3RhdGUudHMiLCJ3ZWJwYWNrOi8vc2VjdGlvbjkvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWl0ZW0udHMiLCJ3ZWJwYWNrOi8vc2VjdGlvbjkvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWxpc3QudHMiLCJ3ZWJwYWNrOi8vc2VjdGlvbjkvLi9zcmMvdXRpbC92YWxpZGF0aW9uLnRzIiwid2VicGFjazovL3NlY3Rpb245Ly4vc3JjL2NvbXBvbmVudHMvcHJvamVjdC1pbnB1dC50cyIsIndlYnBhY2s6Ly9zZWN0aW9uOS8uL3NyYy9hcHAudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gUHJvamVjdCBUeXBlXHJcbmV4cG9ydCBlbnVtIFByb2plY3RTdGF0dXMge0FjdGl2ZSwgRmluaXNoZWR9XHJcbmV4cG9ydCBjbGFzcyBQcm9qZWN0IHtcclxuICBjb25zdHJ1Y3RvcihwdWJsaWMgaWQ6IHN0cmluZywgcHVibGljIHRpdGxlOiBzdHJpbmcsIHB1YmxpYyBkZXNjcmlwdGlvbjogc3RyaW5nLCBwdWJsaWMgcGVvcGxlOiBudW1iZXIsIHB1YmxpYyBzdGF0dXM6IFByb2plY3RTdGF0dXMpIHtcclxuXHJcbiAgfVxyXG59XHJcblxyXG4iLCIvLyBDb21wb25lbnQgQmFzZSBDbGFzcyBcclxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIENvbXBvbmVudDxUIGV4dGVuZHMgSFRNTEVsZW1lbnQsIFUgZXh0ZW5kcyBIVE1MRWxlbWVudD4ge1xyXG4gIHRlbXBsYXRlRWxlbWVudDogSFRNTFRlbXBsYXRlRWxlbWVudDtcclxuICBob3N0RWxlbWVudDogVDtcclxuICBlbGVtZW50OiBVO1xyXG5cclxuICBjb25zdHJ1Y3Rvcih0ZW1wbGF0ZUlkOiBzdHJpbmcsIGhvc3RFbGVtZW50SWQ6IHN0cmluZywgaW5zZXJ0QXRTdGFydDogYm9vbGVhbiwgbmV3RWxlbWVudElkPzogc3RyaW5nKSB7XHJcbiAgICB0aGlzLnRlbXBsYXRlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRlbXBsYXRlSWQpIGFzIEhUTUxUZW1wbGF0ZUVsZW1lbnQ7XHJcbiAgICB0aGlzLmhvc3RFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaG9zdEVsZW1lbnRJZCkgYXMgVDtcclxuXHJcbiAgICBjb25zdCBpbXBvcnRlZE5vZGUgPSBkb2N1bWVudC5pbXBvcnROb2RlKHRoaXMudGVtcGxhdGVFbGVtZW50LmNvbnRlbnQsIHRydWUpXHJcbiAgICB0aGlzLmVsZW1lbnQgPSBpbXBvcnRlZE5vZGUuZmlyc3RFbGVtZW50Q2hpbGQgYXMgVTtcclxuICAgIGlmIChuZXdFbGVtZW50SWQpIHRoaXMuZWxlbWVudC5pZCA9IG5ld0VsZW1lbnRJZFxyXG5cclxuICAgIHRoaXMuYXR0YWNoKGluc2VydEF0U3RhcnQpXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGF0dGFjaChpbnNlcnRBdEJlZ2lubmluZzogYm9vbGVhbikge1xyXG4gICAgdGhpcy5ob3N0RWxlbWVudC5pbnNlcnRBZGphY2VudEVsZW1lbnQoaW5zZXJ0QXRCZWdpbm5pbmcgPyAnYWZ0ZXJiZWdpbicgOiAnYmVmb3JlZW5kJywgdGhpcy5lbGVtZW50KVxyXG4gIH1cclxuXHJcbiAgYWJzdHJhY3QgY29uZmlndXJlKCk6IHZvaWQ7XHJcbiAgYWJzdHJhY3QgcmVuZGVyQ29udGVudCgpOiB2b2lkO1xyXG59XHJcbiIsIi8vIGF1dG9iaW5kIGRlY29yYXRvclxyXG5leHBvcnQgZnVuY3Rpb24gQXV0b2JpbmQodGFyZ2V0OiBhbnksIG1ldGhvZE5hbWU6IHN0cmluZywgZGVzY3JpcHRvcjogUHJvcGVydHlEZXNjcmlwdG9yKSB7XHJcbiAgY29uc29sZS5sb2coZGVzY3JpcHRvcilcclxuICBjb25zdCBhZGp1c3REZXNjcmlwdG9yOiBQcm9wZXJ0eURlc2NyaXB0b3IgPSB7XHJcbiAgICBjb25maWd1cmFibGU6IHRydWUsXHJcbiAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgIGdldCgpIHtcclxuICAgICAgY29uc3QgYm91bmRGbiA9IGRlc2NyaXB0b3IudmFsdWUuYmluZCh0aGlzKVxyXG4gICAgICByZXR1cm4gYm91bmRGblxyXG4gICAgfVxyXG4gIH1cclxuICByZXR1cm4gYWRqdXN0RGVzY3JpcHRvclxyXG59XHJcbiIsImltcG9ydCB7IFByb2plY3QsIFByb2plY3RTdGF0dXMgfSBmcm9tICcuLy4uL21vZGVscy9wcm9qZWN0JztcclxuXHJcbi8vIFByb2plY3Qgc3RhdGUgbWFuYWdlbWVudFxyXG50eXBlIExpc3RlbmVyPFQ+ID0gKGl0ZW1zOiBUW10pID0+IHZvaWQ7XHJcblxyXG5jbGFzcyBTdGF0ZTxUPiB7XHJcbiAgcHJvdGVjdGVkIGxpc3RlbmVyczogTGlzdGVuZXI8VD5bXSA9IFtdO1xyXG5cclxuICBhZGRMaXN0ZW5lcihsaXN0ZW5lckZuOiBMaXN0ZW5lcjxUPikge1xyXG4gICAgdGhpcy5saXN0ZW5lcnMucHVzaChsaXN0ZW5lckZuKVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFByb2plY3RTdGF0ZSBleHRlbmRzIFN0YXRlPFByb2plY3Q+IHtcclxuICBwcml2YXRlIHByb2plY3RzOiBQcm9qZWN0W10gPSBbXTtcclxuICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogUHJvamVjdFN0YXRlO1xyXG5cclxuICBwcml2YXRlIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgc3VwZXIoKVxyXG4gIH1cclxuXHJcbiAgc3RhdGljIGdldEluc3RhbmNlKCkge1xyXG4gICAgaWYgKHRoaXMuaW5zdGFuY2UpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuaW5zdGFuY2VcclxuICAgIH1cclxuICAgIHRoaXMuaW5zdGFuY2UgPSBuZXcgUHJvamVjdFN0YXRlKCk7XHJcbiAgICByZXR1cm4gdGhpcy5pbnN0YW5jZVxyXG4gIH1cclxuXHJcbiAgYWRkUHJvamVjdCh0aXRsZTogc3RyaW5nLCBkZXNjcmlwdGlvbjogc3RyaW5nLCBudW1PZlBlb3BsZTogbnVtYmVyKSB7XHJcbiAgICBjb25zdCBuZXdQcm9qZWN0ID0gbmV3IFByb2plY3QoTWF0aC5yYW5kb20oKS50b1N0cmluZygpLCB0aXRsZSwgZGVzY3JpcHRpb24sIG51bU9mUGVvcGxlLCBQcm9qZWN0U3RhdHVzLkFjdGl2ZSlcclxuICAgIHRoaXMucHJvamVjdHMucHVzaChuZXdQcm9qZWN0KVxyXG4gICAgY29uc29sZS5sb2codGhpcy5wcm9qZWN0cylcclxuICAgIHRoaXMudXBkYXRlTGlzdGVuZXJzKClcclxuICB9XHJcblxyXG4gIG1vdmVQcm9qZWN0KHByb2plY3RJZDogc3RyaW5nLCBuZXdTdGF0dXM6IFByb2plY3RTdGF0dXMpIHtcclxuICAgIGNvbnN0IHByb2plY3QgPSB0aGlzLnByb2plY3RzLmZpbmQocHJqID0+IHByai5pZCA9PT0gcHJvamVjdElkKVxyXG4gICAgaWYgKHByb2plY3QgJiYgcHJvamVjdC5zdGF0dXMgIT09IG5ld1N0YXR1cykge1xyXG4gICAgICBwcm9qZWN0LnN0YXR1cyA9IG5ld1N0YXR1c1xyXG4gICAgICB0aGlzLnVwZGF0ZUxpc3RlbmVycygpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHVwZGF0ZUxpc3RlbmVycygpIHtcclxuICAgIGZvciAoY29uc3QgbGlzdGVuZXJGbiBvZiB0aGlzLmxpc3RlbmVycykge1xyXG4gICAgICBsaXN0ZW5lckZuKHRoaXMucHJvamVjdHMuc2xpY2UoKSlcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBwcm9qZWN0U3RhdGUgPSBQcm9qZWN0U3RhdGUuZ2V0SW5zdGFuY2UoKVxyXG4iLCJpbXBvcnQgeyBEcmFnZ2FibGUgfSBmcm9tICcuLi9tb2RlbHMvZHJhZy1kcm9wJztcclxuaW1wb3J0IHsgUHJvamVjdCB9IGZyb20gJy4uL21vZGVscy9wcm9qZWN0JztcclxuaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSAnLi9iYXNlLWNvbXBvbmVudCc7XHJcbmltcG9ydCB7IEF1dG9iaW5kIH0gZnJvbSAnLi4vZGVjb3JhdG9ycy9hdXRvYmluZCc7XHJcblxyXG4vLyBQcm9qZWN0SXRlbSBDbGFzc1xyXG5leHBvcnQgY2xhc3MgUHJvamVjdEl0ZW0gZXh0ZW5kcyBDb21wb25lbnQ8SFRNTFVMaXN0RWxlbWVudCwgSFRNTExJRWxlbWVudD4gaW1wbGVtZW50cyBEcmFnZ2FibGUge1xyXG4gIHByaXZhdGUgcHJvamVjdDogUHJvamVjdDtcclxuXHJcbiAgZ2V0IHBlcnNvbnMoKSB7XHJcbiAgICBpZiAodGhpcy5wcm9qZWN0LnBlb3BsZSA9PT0gMSkge1xyXG4gICAgICByZXR1cm4gJzEgcGVyc29uJztcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBgJHt0aGlzLnByb2plY3QucGVvcGxlfSBwZXJzb25zYDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGNvbnN0cnVjdG9yKGhvc3RJZDogc3RyaW5nLCBwcm9qZWN0OiBQcm9qZWN0KSB7XHJcbiAgICBzdXBlcignc2luZ2xlLXByb2plY3QnLCBob3N0SWQsIGZhbHNlLCBwcm9qZWN0LmlkKVxyXG4gICAgdGhpcy5wcm9qZWN0ID0gcHJvamVjdFxyXG5cclxuICAgIHRoaXMuY29uZmlndXJlKCk7XHJcbiAgICB0aGlzLnJlbmRlckNvbnRlbnQoKTtcclxuICB9XHJcblxyXG4gIEBBdXRvYmluZFxyXG4gIGRyYWdTdGFydEhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCkge1xyXG4gICAgY29uc29sZS5kaXIoZXZlbnQuZGF0YVRyYW5zZmVyKVxyXG4gICAgZXZlbnQuZGF0YVRyYW5zZmVyIS5zZXREYXRhKCd0ZXh0L3BsYWluJywgdGhpcy5wcm9qZWN0LmlkKTtcclxuICAgIGV2ZW50LmRhdGFUcmFuc2ZlciEuZWZmZWN0QWxsb3dlZCA9ICdtb3ZlJ1xyXG4gIH1cclxuXHJcbiAgZHJhZ0VuZEhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCkge1xyXG4gICAgY29uc29sZS5sb2coJ2RyYWcgZW5kJylcclxuICB9XHJcblxyXG4gIGNvbmZpZ3VyZSgpIHtcclxuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnc3RhcnQnLCB0aGlzLmRyYWdTdGFydEhhbmRsZXIpXHJcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2VuZCcsIHRoaXMuZHJhZ0VuZEhhbmRsZXIpXHJcbiAgfVxyXG5cclxuICByZW5kZXJDb250ZW50KCkge1xyXG4gICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2gyJykhLnRleHRDb250ZW50ID0gdGhpcy5wcm9qZWN0LnRpdGxlXHJcbiAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignaDMnKSEudGV4dENvbnRlbnQgPSB0aGlzLnBlcnNvbnMgKyAnIGFzc2lnbmVkJ1xyXG4gICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3AnKSEudGV4dENvbnRlbnQgPSB0aGlzLnByb2plY3QuZGVzY3JpcHRpb25cclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgUHJvamVjdFN0YXR1cyAsUHJvamVjdCB9IGZyb20gJy4uL21vZGVscy9wcm9qZWN0JztcclxuaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSAnLi9iYXNlLWNvbXBvbmVudCc7XHJcbmltcG9ydCB7IEF1dG9iaW5kIH0gZnJvbSAnLi4vZGVjb3JhdG9ycy9hdXRvYmluZCc7XHJcbmltcG9ydCB7IERyYWdUYXJnZXQgfSBmcm9tICcuLi9tb2RlbHMvZHJhZy1kcm9wJztcclxuaW1wb3J0IHsgcHJvamVjdFN0YXRlIH0gZnJvbSAnLi4vc3RhdGUvcHJvamVjdC1zdGF0ZSc7XHJcbmltcG9ydCB7IFByb2plY3RJdGVtIH0gZnJvbSAnLi9wcm9qZWN0LWl0ZW0nO1xyXG5cclxuLy8gUHJvamVjdExpc3QgY2xhc3NcclxuZXhwb3J0IGNsYXNzIFByb2plY3RMaXN0IGV4dGVuZHMgQ29tcG9uZW50PEhUTUxEaXZFbGVtZW50LCBIVE1MRWxlbWVudD4gaW1wbGVtZW50cyBEcmFnVGFyZ2V0IHtcclxuICBhc3NpZ25lZFByb2plY3RzOiBQcm9qZWN0W107XHJcblxyXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgdHlwZTogJ2FjdGl2ZScgfCAnZmluaXNoZWQnKSB7XHJcbiAgICBzdXBlcigncHJvamVjdC1saXN0JywgJ2FwcCcsIGZhbHNlLCBgJHt0eXBlfS1wcm9qZWN0c2ApXHJcbiAgICB0aGlzLmFzc2lnbmVkUHJvamVjdHMgPSBbXTtcclxuXHJcbiAgICB0aGlzLmNvbmZpZ3VyZSgpXHJcbiAgICB0aGlzLnJlbmRlckNvbnRlbnQoKVxyXG4gIH1cclxuXHJcbiAgQEF1dG9iaW5kXHJcbiAgZHJhZ092ZXJIYW5kbGVyKGV2ZW50OiBEcmFnRXZlbnQpIHtcclxuICAgIGlmIChldmVudC5kYXRhVHJhbnNmZXIgJiYgZXZlbnQuZGF0YVRyYW5zZmVyLnR5cGVzWzBdID09PSAndGV4dC9wbGFpbicpIHtcclxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKVxyXG4gICAgICBjb25zdCBsaXN0RWwgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigndWwnKSE7XHJcbiAgICAgIGxpc3RFbC5jbGFzc0xpc3QuYWRkKCdkcm9wcGFibGUnKVxyXG5cclxuICAgIH1cclxuICB9XHJcblxyXG4gIEBBdXRvYmluZFxyXG4gIGRyb3BIYW5kbGVyKGV2ZW50OiBEcmFnRXZlbnQpIHtcclxuICAgIGNvbnN0IHByaklkID0gZXZlbnQuZGF0YVRyYW5zZmVyIS5nZXREYXRhKCd0ZXh0L3BsYWluJylcclxuICAgIHByb2plY3RTdGF0ZS5tb3ZlUHJvamVjdChwcmpJZCwgdGhpcy50eXBlID09PSAnYWN0aXZlJyA/IFByb2plY3RTdGF0dXMuQWN0aXZlIDogUHJvamVjdFN0YXR1cy5GaW5pc2hlZClcclxuICB9XHJcblxyXG4gIEBBdXRvYmluZFxyXG4gIGRyYWdMZWF2ZUhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCkge1xyXG4gICAgY29uc3QgbGlzdEVsID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhO1xyXG4gICAgbGlzdEVsLmNsYXNzTGlzdC5yZW1vdmUoJ2Ryb3BwYWJsZScpXHJcbiAgfVxyXG5cclxuICBjb25maWd1cmUoKSB7XHJcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ292ZXInLCB0aGlzLmRyYWdPdmVySGFuZGxlcilcclxuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnbGVhdmUnLCB0aGlzLmRyYWdMZWF2ZUhhbmRsZXIpXHJcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJvcCcsIHRoaXMuZHJvcEhhbmRsZXIpXHJcblxyXG4gICAgcHJvamVjdFN0YXRlLmFkZExpc3RlbmVyKChwcm9qZWN0czogUHJvamVjdFtdKSA9PiB7XHJcbiAgICAgIGNvbnN0IHJlbGV2YW50UHJvamVjdHMgPSBwcm9qZWN0cy5maWx0ZXIocHJqID0+IHtcclxuICAgICAgICBpZiAodGhpcy50eXBlID09PSAnYWN0aXZlJykge1xyXG4gICAgICAgICAgcmV0dXJuIHByai5zdGF0dXMgPT09IFByb2plY3RTdGF0dXMuQWN0aXZlXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBwcmouc3RhdHVzID09PSBQcm9qZWN0U3RhdHVzLkZpbmlzaGVkXHJcbiAgICAgIH0pXHJcbiAgICAgIHRoaXMuYXNzaWduZWRQcm9qZWN0cyA9IHJlbGV2YW50UHJvamVjdHM7XHJcbiAgICAgIHRoaXMucmVuZGVyUHJvamVjdHMoKVxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIHJlbmRlckNvbnRlbnQoKSB7XHJcbiAgICBjb25zdCBsaXN0SWQgPSBgJHt0aGlzLnR5cGV9LXByb2plY3RzLWxpc3RgXHJcbiAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigndWwnKSEuaWQgPSBsaXN0SWQ7XHJcbiAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignaDInKSEudGV4dENvbnRlbnQgPSB0aGlzLnR5cGUudG9VcHBlckNhc2UoKSArICcgUFJPSkVDVFMnXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHJlbmRlclByb2plY3RzKCkge1xyXG4gICAgY29uc3QgbGlzdEVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgIyR7dGhpcy50eXBlfS1wcm9qZWN0cy1saXN0YCkgYXMgSFRNTFVMaXN0RWxlbWVudDtcclxuICAgIGxpc3RFbC5pbm5lckhUTUwgPSAnJ1xyXG4gICAgZm9yIChjb25zdCBwcmpJdGVtIG9mIHRoaXMuYXNzaWduZWRQcm9qZWN0cykge1xyXG4gICAgICBuZXcgUHJvamVjdEl0ZW0odGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhLmlkLCBwcmpJdGVtKVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCIvLyBWYWxpZGF0aW9uXHJcbmV4cG9ydCBpbnRlcmZhY2UgVmFsaWRhdGFibGUge1xyXG4gIHZhbHVlOiBzdHJpbmcgfCBudW1iZXI7XHJcbiAgcmVxdWlyZWQ/OiBib29sZWFuO1xyXG4gIG1pbkxlbmd0aD86IG51bWJlcjtcclxuICBtYXhMZW5ndGg/OiBudW1iZXI7XHJcbiAgbWluPzogbnVtYmVyO1xyXG4gIG1heD86IG51bWJlcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlKHZhbGlkYXRhYmFsZUlucHV0OiBWYWxpZGF0YWJsZSkge1xyXG4gIGxldCBpc1ZhbGlkID0gdHJ1ZTtcclxuICBpZiAodmFsaWRhdGFiYWxlSW5wdXQucmVxdWlyZWQpIHtcclxuICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIHZhbGlkYXRhYmFsZUlucHV0LnZhbHVlLnRvU3RyaW5nKCkudHJpbSgpLmxlbmd0aCAhPT0gMFxyXG4gIH1cclxuICBpZiAodmFsaWRhdGFiYWxlSW5wdXQubWluTGVuZ3RoICE9IG51bGwgJiYgdHlwZW9mIHZhbGlkYXRhYmFsZUlucHV0LnZhbHVlID09PSAnc3RyaW5nJykge1xyXG4gICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgdmFsaWRhdGFiYWxlSW5wdXQudmFsdWUubGVuZ3RoID49IHZhbGlkYXRhYmFsZUlucHV0Lm1pbkxlbmd0aFxyXG4gIH1cclxuICBpZiAodmFsaWRhdGFiYWxlSW5wdXQubWF4TGVuZ3RoICE9IG51bGwgJiYgdHlwZW9mIHZhbGlkYXRhYmFsZUlucHV0LnZhbHVlID09PSAnc3RyaW5nJykge1xyXG4gICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgdmFsaWRhdGFiYWxlSW5wdXQudmFsdWUubGVuZ3RoIDw9IHZhbGlkYXRhYmFsZUlucHV0Lm1heExlbmd0aFxyXG4gIH1cclxuICBpZiAodmFsaWRhdGFiYWxlSW5wdXQubWluICE9IG51bGwgJiYgdHlwZW9mIHZhbGlkYXRhYmFsZUlucHV0LnZhbHVlID09PSAnbnVtYmVyJykge1xyXG4gICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgdmFsaWRhdGFiYWxlSW5wdXQudmFsdWUgPj0gdmFsaWRhdGFiYWxlSW5wdXQubWluXHJcbiAgfVxyXG4gIGlmICh2YWxpZGF0YWJhbGVJbnB1dC5tYXggIT0gbnVsbCAmJiB0eXBlb2YgdmFsaWRhdGFiYWxlSW5wdXQudmFsdWUgPT09ICdudW1iZXInKSB7XHJcbiAgICBpc1ZhbGlkID0gaXNWYWxpZCAmJiB2YWxpZGF0YWJhbGVJbnB1dC52YWx1ZSA8PSB2YWxpZGF0YWJhbGVJbnB1dC5tYXhcclxuICB9XHJcbiAgcmV0dXJuIGlzVmFsaWRcclxufVxyXG4iLCJpbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tIFwiLi9iYXNlLWNvbXBvbmVudFwiO1xyXG5pbXBvcnQgeyBWYWxpZGF0YWJsZSwgdmFsaWRhdGUgfSBmcm9tICcuLi91dGlsL3ZhbGlkYXRpb24nXHJcbmltcG9ydCB7IEF1dG9iaW5kIH0gZnJvbSBcIi4uL2RlY29yYXRvcnMvYXV0b2JpbmRcIjtcclxuaW1wb3J0IHsgcHJvamVjdFN0YXRlIH0gZnJvbSBcIi4uL3N0YXRlL3Byb2plY3Qtc3RhdGVcIjtcclxuLy8gUHJvamVjdElucHV0IGNsYXNzXHJcbmV4cG9ydCBjbGFzcyBQcm9qZWN0SW5wdXQgZXh0ZW5kcyBDb21wb25lbnQ8SFRNTERpdkVsZW1lbnQsIEhUTUxGb3JtRWxlbWVudD4ge1xyXG4gIHRpdGxlSW5wdXRFbGVtZW50OiBIVE1MSW5wdXRFbGVtZW50O1xyXG4gIGRlc2NyaXB0aW9uSW5wdXRFbGVtZW50OiBIVE1MSW5wdXRFbGVtZW50O1xyXG4gIHBlb3BsZUlucHV0RWxlbWVudDogSFRNTElucHV0RWxlbWVudDtcclxuXHJcblxyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgc3VwZXIoJ3Byb2plY3QtaW5wdXQnLCAnYXBwJywgdHJ1ZSwgJ3VzZXItaW5wdXQnKVxyXG4gICAgdGhpcy50aXRsZUlucHV0RWxlbWVudCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcjdGl0bGUnKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgdGhpcy5kZXNjcmlwdGlvbklucHV0RWxlbWVudCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcjZGVzY3JpcHRpb24nKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgdGhpcy5wZW9wbGVJbnB1dEVsZW1lbnQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignI3Blb3BsZScpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgICB0aGlzLmNvbmZpZ3VyZSgpXHJcbiAgfVxyXG5cclxuICBjb25maWd1cmUoKSB7XHJcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgdGhpcy5zdWJtaXRIYW5kbGVyKVxyXG4gIH1cclxuXHJcbiAgcmVuZGVyQ29udGVudCgpOiB2b2lkIHtcclxuICAgICAgXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdhdGhlclVzZXJJbnB1dCgpOiBbc3RyaW5nLCBzdHJpbmcsIG51bWJlcl0gfCB2b2lkIHtcclxuICAgIGNvbnN0IGVudGVyZWRUaXRsZSA9IHRoaXMudGl0bGVJbnB1dEVsZW1lbnQudmFsdWU7XHJcbiAgICBjb25zdCBlbnRlcmVkRGVzY3JpcHRpb24gPSB0aGlzLmRlc2NyaXB0aW9uSW5wdXRFbGVtZW50LnZhbHVlO1xyXG4gICAgY29uc3QgZW50ZXJlZFBlb3BsZSA9IHRoaXMucGVvcGxlSW5wdXRFbGVtZW50LnZhbHVlO1xyXG5cclxuICAgIGNvbnN0IHRpdGxlVmFsaWRhdGFibGU6IFZhbGlkYXRhYmxlID0ge1xyXG4gICAgICB2YWx1ZTogZW50ZXJlZFRpdGxlLFxyXG4gICAgICByZXF1aXJlZDogdHJ1ZVxyXG4gICAgfVxyXG4gICAgY29uc3QgZGVzY3JpcHRpb25WYWxpZGF0YWJsZTogVmFsaWRhdGFibGUgPSB7XHJcbiAgICAgIHZhbHVlOiBlbnRlcmVkRGVzY3JpcHRpb24sXHJcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICBtaW5MZW5ndGg6IDVcclxuICAgIH1cclxuICAgIGNvbnN0IHBlb3BsZVZhbGlkYXRhYmxlOiBWYWxpZGF0YWJsZSA9IHtcclxuICAgICAgdmFsdWU6ICtlbnRlcmVkUGVvcGxlLFxyXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgICAgbWluOiAxLFxyXG4gICAgICBtYXg6IDVcclxuICAgIH1cclxuXHJcbiAgICBpZiAoXHJcbiAgICAgICF2YWxpZGF0ZSh0aXRsZVZhbGlkYXRhYmxlKSB8fFxyXG4gICAgICAhdmFsaWRhdGUoZGVzY3JpcHRpb25WYWxpZGF0YWJsZSkgfHwgXHJcbiAgICAgICF2YWxpZGF0ZShwZW9wbGVWYWxpZGF0YWJsZSlcclxuICAgICkge1xyXG4gICAgICBhbGVydCgnaW52YWxpZCBpbnB1dCwgcGxlYXNlIHRyeSBhZ2FpbicpXHJcbiAgICAgIHJldHVybiA7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gW2VudGVyZWRUaXRsZSwgZW50ZXJlZERlc2NyaXB0aW9uLCArZW50ZXJlZFBlb3BsZV1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgY2xlYXJJbnB1dHMoKSB7XHJcbiAgICB0aGlzLnRpdGxlSW5wdXRFbGVtZW50LnZhbHVlID0gJyc7XHJcbiAgICB0aGlzLmRlc2NyaXB0aW9uSW5wdXRFbGVtZW50LnZhbHVlID0gJyc7XHJcbiAgICB0aGlzLnBlb3BsZUlucHV0RWxlbWVudC52YWx1ZSA9ICcnO1xyXG4gIH1cclxuXHJcbiAgQEF1dG9iaW5kXHJcbiAgcHJpdmF0ZSBzdWJtaXRIYW5kbGVyKGV2ZW50OiBFdmVudCkge1xyXG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIGNvbnNvbGUubG9nKHRoaXMudGl0bGVJbnB1dEVsZW1lbnQudmFsdWUpXHJcbiAgICBjb25zdCB1c2VySW5wdXQgPSB0aGlzLmdhdGhlclVzZXJJbnB1dCgpXHJcblxyXG4gICAgaWYgKEFycmF5LmlzQXJyYXkodXNlcklucHV0KSkge1xyXG4gICAgICBjb25zdCBbdGl0bGUsIGRlc2MsIHBlb3BsZV0gPSB1c2VySW5wdXQ7XHJcbiAgICAgIHByb2plY3RTdGF0ZS5hZGRQcm9qZWN0KHRpdGxlLCBkZXNjLCBwZW9wbGUpXHJcbiAgICAgIGNvbnNvbGUubG9nKHRpdGxlLCBkZXNjLCBwZW9wbGUpXHJcbiAgICAgIHRoaXMuY2xlYXJJbnB1dHMoKVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCIvLyDslYTrnpgg7L2U65Oc64qUIHR5cGVzY3JpcHTsl5DshJwg7IKs7JqpIOqwgOuKpe2VnCDsvZTrk5zsnbTri6QuID0+IOuEpOyehOyKpO2OmOydtOyKpOulvCDsgqzsmqntlZjquLAg7JyE7ZWcIOy9lOuTnFxyXG4vLyAvIDxyZWZlcmVuY2UgcGF0aD1cIm1vZGVscy9kcmFnLWRyb3AudHNcIiAvPlxyXG4vLyAvIDxyZWZlcmVuY2UgcGF0aD1cIm1vZGVscy9wcm9qZWN0LnRzXCIgLz5cclxuLy8gLyA8cmVmZXJlbmNlIHBhdGg9XCJzdGF0ZS9wcm9qZWN0LXN0YXRlLnRzXCIgLz5cclxuLy8gLyA8cmVmZXJlbmNlIHBhdGg9XCJ1dGlsL3ZhbGlkYXRpb24udHNcIiAvPlxyXG4vLyAvIDxyZWZlcmVuY2UgcGF0aD1cImRlY29yYXRvcnMvYXV0b2JpbmQudHNcIiAvPlxyXG4vLyAvIDxyZWZlcmVuY2UgcGF0aD1cImNvbXBvbmVudHMvcHJvamVjdC1pbnB1dC50c1wiIC8+XHJcbi8vIC8gPHJlZmVyZW5jZSBwYXRoPVwiY29tcG9uZW50cy9wcm9qZWN0LWxpc3QudHNcIiAvPlxyXG5cclxuLy8gZXM2IOuqqOuTiCDsnoTtj6ztirhcclxuaW1wb3J0IHsgUHJvamVjdExpc3QgfSBmcm9tICcuL2NvbXBvbmVudHMvcHJvamVjdC1saXN0JztcclxuaW1wb3J0IHsgUHJvamVjdElucHV0IH0gZnJvbSAnLi9jb21wb25lbnRzL3Byb2plY3QtaW5wdXQnO1xyXG5cclxuXHJcbm5ldyBQcm9qZWN0SW5wdXQoKVxyXG5uZXcgUHJvamVjdExpc3QoJ2FjdGl2ZScpXHJcbm5ldyBQcm9qZWN0TGlzdCgnZmluaXNoZWQnKVxyXG5cclxuXHJcblxyXG4iXSwibmFtZXMiOlsiUHJvamVjdFN0YXR1cyIsIlByb2plY3QiLCJjb25zdHJ1Y3RvciIsImlkIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsInBlb3BsZSIsInN0YXR1cyIsIkNvbXBvbmVudCIsInRlbXBsYXRlSWQiLCJob3N0RWxlbWVudElkIiwiaW5zZXJ0QXRTdGFydCIsIm5ld0VsZW1lbnRJZCIsInRoaXMiLCJ0ZW1wbGF0ZUVsZW1lbnQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiaG9zdEVsZW1lbnQiLCJpbXBvcnRlZE5vZGUiLCJpbXBvcnROb2RlIiwiY29udGVudCIsImVsZW1lbnQiLCJmaXJzdEVsZW1lbnRDaGlsZCIsImF0dGFjaCIsImluc2VydEF0QmVnaW5uaW5nIiwiaW5zZXJ0QWRqYWNlbnRFbGVtZW50IiwiQXV0b2JpbmQiLCJ0YXJnZXQiLCJtZXRob2ROYW1lIiwiZGVzY3JpcHRvciIsImNvbnNvbGUiLCJsb2ciLCJjb25maWd1cmFibGUiLCJlbnVtZXJhYmxlIiwiZ2V0IiwidmFsdWUiLCJiaW5kIiwiUHJvamVjdFN0YXRlIiwibGlzdGVuZXJzIiwiYWRkTGlzdGVuZXIiLCJsaXN0ZW5lckZuIiwicHVzaCIsInN1cGVyIiwicHJvamVjdHMiLCJzdGF0aWMiLCJpbnN0YW5jZSIsImFkZFByb2plY3QiLCJudW1PZlBlb3BsZSIsIm5ld1Byb2plY3QiLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJBY3RpdmUiLCJ1cGRhdGVMaXN0ZW5lcnMiLCJtb3ZlUHJvamVjdCIsInByb2plY3RJZCIsIm5ld1N0YXR1cyIsInByb2plY3QiLCJmaW5kIiwicHJqIiwic2xpY2UiLCJwcm9qZWN0U3RhdGUiLCJnZXRJbnN0YW5jZSIsIlByb2plY3RJdGVtIiwiaG9zdElkIiwiY29uZmlndXJlIiwicmVuZGVyQ29udGVudCIsInBlcnNvbnMiLCJkcmFnU3RhcnRIYW5kbGVyIiwiZXZlbnQiLCJkaXIiLCJkYXRhVHJhbnNmZXIiLCJzZXREYXRhIiwiZWZmZWN0QWxsb3dlZCIsImRyYWdFbmRIYW5kbGVyIiwiYWRkRXZlbnRMaXN0ZW5lciIsInF1ZXJ5U2VsZWN0b3IiLCJ0ZXh0Q29udGVudCIsIlByb2plY3RMaXN0IiwidHlwZSIsImFzc2lnbmVkUHJvamVjdHMiLCJkcmFnT3ZlckhhbmRsZXIiLCJ0eXBlcyIsInByZXZlbnREZWZhdWx0IiwiY2xhc3NMaXN0IiwiYWRkIiwiZHJvcEhhbmRsZXIiLCJwcmpJZCIsImdldERhdGEiLCJGaW5pc2hlZCIsImRyYWdMZWF2ZUhhbmRsZXIiLCJyZW1vdmUiLCJyZWxldmFudFByb2plY3RzIiwiZmlsdGVyIiwicmVuZGVyUHJvamVjdHMiLCJsaXN0SWQiLCJ0b1VwcGVyQ2FzZSIsImlubmVySFRNTCIsInByakl0ZW0iLCJ2YWxpZGF0ZSIsInZhbGlkYXRhYmFsZUlucHV0IiwiaXNWYWxpZCIsInJlcXVpcmVkIiwidHJpbSIsImxlbmd0aCIsIm1pbkxlbmd0aCIsIm1heExlbmd0aCIsIm1pbiIsIm1heCIsIlByb2plY3RJbnB1dCIsInRpdGxlSW5wdXRFbGVtZW50IiwiZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQiLCJwZW9wbGVJbnB1dEVsZW1lbnQiLCJzdWJtaXRIYW5kbGVyIiwiZ2F0aGVyVXNlcklucHV0IiwiZW50ZXJlZFRpdGxlIiwiZW50ZXJlZERlc2NyaXB0aW9uIiwiZW50ZXJlZFBlb3BsZSIsImRlc2NyaXB0aW9uVmFsaWRhdGFibGUiLCJwZW9wbGVWYWxpZGF0YWJsZSIsImFsZXJ0IiwiY2xlYXJJbnB1dHMiLCJ1c2VySW5wdXQiLCJBcnJheSIsImlzQXJyYXkiLCJkZXNjIl0sInNvdXJjZVJvb3QiOiIifQ==